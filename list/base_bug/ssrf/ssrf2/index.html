<!DOCTYPE html>
<html lang="en"><head>
    <link rel="stylesheet" href="/css/custom.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSRF 漏洞原理、挖掘与绕过</title>
    <meta charset="utf-8">
    <meta name="description" content="Ladder@SSRF 漏洞原理、挖掘与绕过 - Hzhsrc home">
    <meta name="author" content="hzhsec">
    <link rel="canonical" href="https://hzhsec.github.io/list/base_bug/ssrf/ssrf2/">

    <link rel="alternate" type="application/rss+xml" href="https://hzhsec.github.io//index.xml" title="Hzhsrc home">

    


<script async defer data-website-id="3bfa7bff-77f4-4fe9-ad96-a44d83f72465" src="https://umami-evtq.vercel.app/baize"></script>

    <meta property="og:title" content="SSRF 漏洞原理、挖掘与绕过" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hzhsec.github.io/list/base_bug/ssrf/ssrf2/" /><meta property="article:section" content="list" />
<meta property="article:published_time" content="2024-05-10T15:55:00+08:00" />
<meta property="article:modified_time" content="2024-05-10T15:55:00+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SSRF 漏洞原理、挖掘与绕过"/>
<meta name="twitter:description" content=""/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "目录",
      "item": "https://hzhsec.github.io/list/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "基础漏洞",
      "item": "https://hzhsec.github.io/list/base_bug/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "SSRF服务端请求伪造",
      "item": "https://hzhsec.github.io/list/base_bug/ssrf/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "SSRF 漏洞原理、挖掘与绕过",
      "item": "https://hzhsec.github.io/list/base_bug/ssrf/ssrf2/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SSRF 漏洞原理、挖掘与绕过",
  "name": "SSRF 漏洞原理、挖掘与绕过",
  "description": "",
  "keywords": [
    
  ],
  "articleBody": "概述 SSRF（Server-Side Request Forgery，服务器端请求伪造） 是一种由攻击者构造目标 URL，使服务器端代为发起请求，从而访问到外网无法直接访问的内部资源或服务的漏洞。由于请求是由服务端发起，攻击者可借此触达与外网隔离的内网主机与服务。\nSSRF 常见成因：服务端提供从其它 URL 获取数据的功能，但对目标地址未做充分过滤或限制（例如未限制协议、未白名单域名、未校验 IP 范围等）。\n一、SSRF 漏洞原理 攻击者构造或诱导受害服务去访问攻击者控制的 URL 或内部资源。 服务端收到 URL 后代为访问，并把结果（页面、文件或响应）返回或用于后续流程，进而泄露内部信息或触发内部服务。 SSRF 的核心：服务端具有“代理/抓取/回调”外部资源的能力且没有严格校验目标地址。 二、SSRF 漏洞挖掘（黑盒与白盒） 黑盒探针（常见可被利用的业务功能点） 社交分享：抓取 URL 标题、缩略图等。 转码服务：通过 URL 获取内容并转码（适配移动端）。 在线翻译：翻译远程网页内容。 图片加载/下载：富文本编辑器的图片导入或下载功能。 图片/文章收藏：抓取并存储 URL 的 title/摘要以供展示。 云服务厂商：远程探测站点是否存活、拉取资源等。 网站采集/抓取功能：用户输入 URL 后会被抓取并处理。 数据库内置功能（例如 MongoDB 的 copyDatabase）可触发外部请求。 邮件系统：处理邮件时可能访问远程资源（如外部图片）。 文件/编码处理库：ImageMagick、ffmpeg、docx/pdf/xml 解析器等。 未公开的 API 或扩展：通过搜索引擎与关键词组合可发现调用 URL 的入口（如 google dorking）。 常见可能包含 URL 的参数（可作为爆破字典） share, wap, url, link, src, source, target, u, display, sourceURL, imageURL, domain 白盒分析 代码审计优先查看：文件读取、网络请求、URL 拼接、XML/HTML/图片处理、第三方库调用等位置，关注是否存在未过滤的外部输入直接作为请求目标的情况。 三、可利用的伪协议（SSRF 利用面） http:// # 常见 Web 访问，例如 http://127.0.0.1 file:/// # 读取本地文件，例如 file:///etc/passwd dict:// # 访问字典服务器资源，例如 dict://ip:port/info sftp:// # SSH 文件传输（或安全传输） ldap:// # 轻量目录访问协议 tftp:// # 简单文件传输协议 gopher:// # 原始 TCP 字节流传输（常用于向数据库/Redis/SMTP 发送协议字节） 注：gopher 常与工具（如 Gopherus）配合，生成针对性 payload，用于与内部服务（MySQL、Redis、SMTP 等）进行原始协议通信。\n四、SSRF 绕过方式与示例 场景 绕过方法与示例 限制为 http://www.xxx.com 域名 利用基本认证符号 @ 绕过：http://www.xxx.com@www.xxyy.com 禁止内网 IP 1) 短网址绕过（URL 缩短后解析为内网 IP） 2) 将域名解析到内网（自定义域名指向 127.0.0.1） 3) IP 进制转换（十六进制/八进制/十进制） 4) 通过 3xx 重定向 IP 进制与特殊写法 十六进制：http://0x7F.0.0.1/flag.php 八进制：http://0177.0.0.1/flag.php 十进制整数：http://2130706433/flag.php 十六进制整数：http://0x7F000001/flag.php 省略模式：http://127.1/flag.php DNS 解析到内网地址 在外部解析一个域名到 127.0.0.1：test.example.com -\u003e 127.0.0.1 后访问 http://test.example.com/flag.php 使用重定向 目标通过重定向指向内网：在你的主机返回 Location: http://127.0.0.1/flag.php，触发服务端重定向访问内网。 匹配不影响解析 在 URL 中加入不会影响解析的字符：http://ctf.@127.0.0.1/flag.php?show 长度/格式限制绕过 使用 http://0/flag.php、http://0.0.0.0/flag.php 等非常规写法 五、CTF 常用绕过示例（汇总） 示例 URL：\n# 直接访问内网 url=http://127.0.0.1/flag.php # 十六进制、八进制、十进制格式 url=http://0x7F.0.0.1/flag.php url=http://0177.0.0.1/flag.php url=http://2130706433/flag.php url=http://0x7F000001/flag.php # 省略与特殊写法 url=http://127.1/flag.php url=http://0/flag.php url=http://0.0.0.0/flag.php # DNS 劫持解析到内网 # test.xiaodi8.com -\u003e 127.0.0.1 url=http://test.xiaodi8.com/flag.php # 重定向绕过（远端脚本返回 Location 头） # target 返回 header(\"Location:http://127.0.0.1/flag.php\"); url=http://47.94.236.117/xx.php # 含 @ 的写法 url=http://ctf.@127.0.0.1/flag.php?show 六、gopher 工具与示例（打服务） 推荐工具：Gopherus（GitHub：tarunkant/Gopherus） 示例命令（Windows 风格示例）： # MySQL exploit d:\\Python2.7\\python.exe gopherus.py --exploit mysql # Redis exploit d:\\Python2.7\\python.exe gopherus.py --exploit redis 使用 gopher 时，通常要把要发送的原始协议字节流进行特殊编码（例如 URL 编码），以便在 gopher:// 的路径部分传递。\n七、SSRF 防御建议 白名单校验：只允许访问受信任的外部域名/主机列表（并对返回的 IP 进行二次检查）。 协议限制：仅允许 http/https，禁用 file://、gopher://、ftp:// 等危险协议。 端口限制：限制可访问的端口集合（例如仅 80、443、8080、8443 等）。 内网 IP 过滤：拒绝所有指向内网地址段（如 10.0.0.0/8、172.16.0.0/12、192.168.0.0/16、127.0.0.0/8）或链路本地/特殊地址的请求。 禁止不必要的重定向：限制或审计 3xx 重定向行为，避免被利用重定向到内网。 统一错误响应：隐藏详细错误信息，避免泄露端口/服务存活信息。 禁止危险功能：禁用不必要的服务端文件读取、远程协议解析或命令执行能力。 安全检测与审计：对外部 URL 请求加日志、限速、熔断，并对异常访问进行告警。 ",
  "wordCount" : "253",
  "inLanguage": "en",
  "datePublished": "2024-05-10T15:55:00+08:00",
  "dateModified": "2024-05-10T15:55:00+08:00",
  "author":{
    "@type": "Person",
    "name": "hzhsec"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://hzhsec.github.io/list/base_bug/ssrf/ssrf2/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Hzhsrc home",
    "logo": {
      "@type": "ImageObject",
      "url": "https://hzhsec.github.io/favicon.ico"
    }
  }
}
</script>
    <link rel="icon" href="/static/hzhsec.png" sizes="16x16">

<link rel="apple-touch-icon" href="/static/hzhsec.png">

<link rel="manifest" href="/static/hzhsec.png">
    

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/style.css" />

    
    
    <link rel="stylesheet" href="/css/main.min.ec28f09e946fc0df77c187fcd0d0ebde58fca6de8efb8e1620f3d45c32d4da88.css" integrity="sha256-7CjwnpRvwN93wYf80NDr3lj8pt6O&#43;44WIPPUXDLU2og=" crossorigin="anonymous" media="screen" />

    
    <link rel="stylesheet" href="/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css" />

    
    <script src="/js/highlight.min.min.c098d85b5396dec4707ea2cead1445b4dc2ff0fc56b8dbbd9049d0d1c50ad237.js"></script>
    <script>hljs.highlightAll();</script>

    <script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script>
    </head>
<body>
      <main class="wrapper"><nav class="navigation">
    <section class="container">
        <a class="navigation-brand" href="/">
            主页
        </a>
        <input type="checkbox" id="menu-toggle" />
        <label class="menu-button float-right" for="menu-toggle">
            <span></span><span></span><span></span>
        </label>
        
        <ul class="navigation-list" id="navigation-list">
            
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/list/">目录</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/archives/">归档</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/message/">关于</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/categories/">分类</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="https://umami-evtq.vercel.app/share/NdRAzdY1AwLB5KF2/hzhsec.github.io">网站统计</a>
            </li>
            
            

            <li class="navigation-item menu-separator">
                <span>|</span>
            </li>

            
            
            <li class="navigation-item navigation-social">
                <a class="navigation-link" href="https://github.com/hzhsec">    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
         stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github">
      <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
    </svg>
    </a>
            </li>
            
            <li class="navigation-item navigation-social">
                <a class="navigation-link" href="/message/">    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
         stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail">
      <path d="M4 4h16v16H4z"></path><polyline points="4,4 12,12 20,4"></polyline>
    </svg>
    </a>
            </li>
            
            

            <li class="navigation-item navigation-dark">
                <button id="mode" type="button" aria-label="toggle user light or dark theme">
                    <span class="toggle-dark">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                             stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </span>
                    <span class="toggle-light">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                             stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </span>
                </button>
            </li>
            
        </ul>
        
    </section>
</nav>

<div id="content">
<article class="blog-single">
  <header class="blog-title">
    <h1>SSRF 漏洞原理、挖掘与绕过</h1>
  </header>

  <p>
  <small>
    May 10, 2024&nbsp;· 253 words&nbsp;· 2 min</small>

  
<p>

  <div class="blog-toc">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#概述">概述</a></li>
    <li><a href="#一ssrf-漏洞原理">一、SSRF 漏洞原理</a></li>
    <li><a href="#二ssrf-漏洞挖掘黑盒与白盒">二、SSRF 漏洞挖掘（黑盒与白盒）</a>
      <ul>
        <li><a href="#黑盒探针常见可被利用的业务功能点">黑盒探针（常见可被利用的业务功能点）</a></li>
        <li><a href="#常见可能包含-url-的参数可作为爆破字典">常见可能包含 URL 的参数（可作为爆破字典）</a></li>
        <li><a href="#白盒分析">白盒分析</a></li>
      </ul>
    </li>
    <li><a href="#三可利用的伪协议ssrf-利用面">三、可利用的伪协议（SSRF 利用面）</a></li>
    <li><a href="#四ssrf-绕过方式与示例">四、SSRF 绕过方式与示例</a></li>
    <li><a href="#五ctf-常用绕过示例汇总">五、CTF 常用绕过示例（汇总）</a></li>
    <li><a href="#六gopher-工具与示例打服务">六、gopher 工具与示例（打服务）</a></li>
    <li><a href="#七ssrf-防御建议">七、SSRF 防御建议</a></li>
    <li><a href="#heading"></a></li>
  </ul>
</nav>
  </div>

  <section class="blog-content"><h2 id="概述">概述</h2>
<p><strong>SSRF（Server-Side Request Forgery，服务器端请求伪造）</strong> 是一种由攻击者构造目标 URL，使服务器端代为发起请求，从而访问到外网无法直接访问的内部资源或服务的漏洞。由于请求是由服务端发起，攻击者可借此触达与外网隔离的内网主机与服务。</p>
<p>SSRF 常见成因：服务端提供从其它 URL 获取数据的功能，但对目标地址未做充分过滤或限制（例如未限制协议、未白名单域名、未校验 IP 范围等）。</p>
<hr>
<h2 id="一ssrf-漏洞原理">一、SSRF 漏洞原理</h2>
<ul>
<li>攻击者构造或诱导受害服务去访问攻击者控制的 URL 或内部资源。</li>
<li>服务端收到 URL 后代为访问，并把结果（页面、文件或响应）返回或用于后续流程，进而泄露内部信息或触发内部服务。</li>
<li>SSRF 的核心：服务端具有“代理/抓取/回调”外部资源的能力且没有严格校验目标地址。</li>
</ul>
<hr>
<h2 id="二ssrf-漏洞挖掘黑盒与白盒">二、SSRF 漏洞挖掘（黑盒与白盒）</h2>
<h3 id="黑盒探针常见可被利用的业务功能点">黑盒探针（常见可被利用的业务功能点）</h3>
<ul>
<li>社交分享：抓取 URL 标题、缩略图等。</li>
<li>转码服务：通过 URL 获取内容并转码（适配移动端）。</li>
<li>在线翻译：翻译远程网页内容。</li>
<li>图片加载/下载：富文本编辑器的图片导入或下载功能。</li>
<li>图片/文章收藏：抓取并存储 URL 的 title/摘要以供展示。</li>
<li>云服务厂商：远程探测站点是否存活、拉取资源等。</li>
<li>网站采集/抓取功能：用户输入 URL 后会被抓取并处理。</li>
<li>数据库内置功能（例如 MongoDB 的 copyDatabase）可触发外部请求。</li>
<li>邮件系统：处理邮件时可能访问远程资源（如外部图片）。</li>
<li>文件/编码处理库：ImageMagick、ffmpeg、docx/pdf/xml 解析器等。</li>
<li>未公开的 API 或扩展：通过搜索引擎与关键词组合可发现调用 URL 的入口（如 google dorking）。</li>
</ul>
<h3 id="常见可能包含-url-的参数可作为爆破字典">常见可能包含 URL 的参数（可作为爆破字典）</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>share, wap, url, link, src, source, target, u, display, sourceURL, imageURL, domain
</span></span></code></pre></div><h3 id="白盒分析">白盒分析</h3>
<ul>
<li>代码审计优先查看：文件读取、网络请求、URL 拼接、XML/HTML/图片处理、第三方库调用等位置，关注是否存在未过滤的外部输入直接作为请求目标的情况。</li>
</ul>
<hr>
<h2 id="三可利用的伪协议ssrf-利用面">三、可利用的伪协议（SSRF 利用面）</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>http://    # 常见 Web 访问，例如 http://127.0.0.1
</span></span><span style="display:flex;"><span>file:///   # 读取本地文件，例如 file:///etc/passwd
</span></span><span style="display:flex;"><span>dict://    # 访问字典服务器资源，例如 dict://ip:port/info
</span></span><span style="display:flex;"><span>sftp://    # SSH 文件传输（或安全传输）
</span></span><span style="display:flex;"><span>ldap://    # 轻量目录访问协议
</span></span><span style="display:flex;"><span>tftp://    # 简单文件传输协议
</span></span><span style="display:flex;"><span>gopher://  # 原始 TCP 字节流传输（常用于向数据库/Redis/SMTP 发送协议字节）
</span></span></code></pre></div><blockquote>
<p>注：<code>gopher</code> 常与工具（如 Gopherus）配合，生成针对性 payload，用于与内部服务（MySQL、Redis、SMTP 等）进行原始协议通信。</p>
</blockquote>
<hr>
<h2 id="四ssrf-绕过方式与示例">四、SSRF 绕过方式与示例</h2>
<table>
<thead>
<tr>
<th>场景</th>
<th>绕过方法与示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>限制为 <code>http://www.xxx.com</code> 域名</td>
<td>利用基本认证符号 <code>@</code> 绕过：<code>http://www.xxx.com@www.xxyy.com</code></td>
</tr>
<tr>
<td>禁止内网 IP</td>
<td>1) 短网址绕过（URL 缩短后解析为内网 IP） 2) 将域名解析到内网（自定义域名指向 127.0.0.1） 3) IP 进制转换（十六进制/八进制/十进制） 4) 通过 3xx 重定向</td>
</tr>
<tr>
<td>IP 进制与特殊写法</td>
<td>十六进制：<code>http://0x7F.0.0.1/flag.php</code> 八进制：<code>http://0177.0.0.1/flag.php</code> 十进制整数：<code>http://2130706433/flag.php</code> 十六进制整数：<code>http://0x7F000001/flag.php</code> 省略模式：<code>http://127.1/flag.php</code></td>
</tr>
<tr>
<td>DNS 解析到内网地址</td>
<td>在外部解析一个域名到 <code>127.0.0.1</code>：<code>test.example.com -&gt; 127.0.0.1</code> 后访问 <code>http://test.example.com/flag.php</code></td>
</tr>
<tr>
<td>使用重定向</td>
<td>目标通过重定向指向内网：在你的主机返回 <code>Location: http://127.0.0.1/flag.php</code>，触发服务端重定向访问内网。</td>
</tr>
<tr>
<td>匹配不影响解析</td>
<td>在 URL 中加入不会影响解析的字符：<code>http://ctf.@127.0.0.1/flag.php?show</code></td>
</tr>
<tr>
<td>长度/格式限制绕过</td>
<td>使用 <code>http://0/flag.php</code>、<code>http://0.0.0.0/flag.php</code> 等非常规写法</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="五ctf-常用绕过示例汇总">五、CTF 常用绕过示例（汇总）</h2>
<p>示例 URL：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># 直接访问内网
</span></span><span style="display:flex;"><span>url=http://127.0.0.1/flag.php
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># 十六进制、八进制、十进制格式
</span></span><span style="display:flex;"><span>url=http://0x7F.0.0.1/flag.php
</span></span><span style="display:flex;"><span>url=http://0177.0.0.1/flag.php
</span></span><span style="display:flex;"><span>url=http://2130706433/flag.php
</span></span><span style="display:flex;"><span>url=http://0x7F000001/flag.php
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># 省略与特殊写法
</span></span><span style="display:flex;"><span>url=http://127.1/flag.php
</span></span><span style="display:flex;"><span>url=http://0/flag.php
</span></span><span style="display:flex;"><span>url=http://0.0.0.0/flag.php
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># DNS 劫持解析到内网
</span></span><span style="display:flex;"><span># test.xiaodi8.com -&gt; 127.0.0.1
</span></span><span style="display:flex;"><span>url=http://test.xiaodi8.com/flag.php
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># 重定向绕过（远端脚本返回 Location 头）
</span></span><span style="display:flex;"><span># target 返回 header(&#34;Location:http://127.0.0.1/flag.php&#34;);
</span></span><span style="display:flex;"><span>url=http://47.94.236.117/xx.php
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># 含 @ 的写法
</span></span><span style="display:flex;"><span>url=http://ctf.@127.0.0.1/flag.php?show
</span></span></code></pre></div><hr>
<h2 id="六gopher-工具与示例打服务">六、gopher 工具与示例（打服务）</h2>
<ul>
<li>推荐工具：Gopherus（GitHub：tarunkant/Gopherus）</li>
<li>示例命令（Windows 风格示例）：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># MySQL exploit
</span></span><span style="display:flex;"><span>d:\Python2.7\python.exe gopherus.py --exploit mysql
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Redis exploit
</span></span><span style="display:flex;"><span>d:\Python2.7\python.exe gopherus.py --exploit redis
</span></span></code></pre></div><blockquote>
<p>使用 gopher 时，通常要把要发送的原始协议字节流进行特殊编码（例如 URL 编码），以便在 <code>gopher://</code> 的路径部分传递。</p>
</blockquote>
<hr>
<h2 id="七ssrf-防御建议">七、SSRF 防御建议</h2>
<ol>
<li><strong>白名单校验</strong>：只允许访问受信任的外部域名/主机列表（并对返回的 IP 进行二次检查）。</li>
<li><strong>协议限制</strong>：仅允许 <code>http</code>/<code>https</code>，禁用 <code>file://</code>、<code>gopher://</code>、<code>ftp://</code> 等危险协议。</li>
<li><strong>端口限制</strong>：限制可访问的端口集合（例如仅 80、443、8080、8443 等）。</li>
<li><strong>内网 IP 过滤</strong>：拒绝所有指向内网地址段（如 <code>10.0.0.0/8</code>、<code>172.16.0.0/12</code>、<code>192.168.0.0/16</code>、<code>127.0.0.0/8</code>）或链路本地/特殊地址的请求。</li>
<li><strong>禁止不必要的重定向</strong>：限制或审计 3xx 重定向行为，避免被利用重定向到内网。</li>
<li><strong>统一错误响应</strong>：隐藏详细错误信息，避免泄露端口/服务存活信息。</li>
<li><strong>禁止危险功能</strong>：禁用不必要的服务端文件读取、远程协议解析或命令执行能力。</li>
<li><strong>安全检测与审计</strong>：对外部 URL 请求加日志、限速、熔断，并对异常访问进行告警。</li>
</ol>
<h2 id="heading"></h2></section>

  
  
  <div class="paginator">
    
    <a class="prev" href="https://hzhsec.github.io/list/app/app1/">
      <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375C21.4339 3.93962 21.3581 3.30535 21.1917 2.76787M3.77086 21.1546C1.9934 20.7777 0.973585 18.7264 1.08749 16.688C1.2668 13.479 1.15721 9.43135 1.00513 6.21507C0.87809 3.52811 3.12891 1.16316 5.51029 1.25008C9.76594 1.40542 15.377 1.20229 18.7912 1.00542C20.0864 0.930734 20.8406 1.63385 21.1917 2.76787M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787C23.1097 4.18217 23.13 12.4191 22.9004 16.3608C20.8478 24.0194 12.3061 23.6662 6.5 22.0658M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608C21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966C5.98257 11.8297 5.98456 11.9753 6.05061 12.0063C7.05496 12.4779 8.92941 13.9264 9.94496 15M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentColor" stroke-linecap="round"/>
      </svg>
      <span>APP 渗透分析：Mobexler、MobSF 与证书绕过实践</span></a>
    
    
    <a class="next" href="https://hzhsec.github.io/list/base_bug/csrf/csrf/"><span>CSRF 防护实践：检测、绕过与防御</span>
      <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375C21.4339 3.93962 21.3581 3.30535 21.1917 2.76787M3.77086 21.1546C1.9934 20.7777 0.973585 18.7264 1.08749 16.688C1.2668 13.479 1.15721 9.43135 1.00513 6.21507C0.87809 3.52811 3.12891 1.16316 5.51029 1.25008C9.76594 1.40542 15.377 1.20229 18.7912 1.00542C20.0864 0.930734 20.8406 1.63385 21.1917 2.76787M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787C23.1097 4.18217 23.13 12.4191 22.9004 16.3608C20.8478 24.0194 12.3061 23.6662 6.5 22.0658M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608C21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966C16.0174 11.8297 16.0154 11.9753 15.9494 12.0063C14.945 12.4779 13.0706 13.9264 12.055 15M15.5556 11.9667C13.1345 12.0608 8 12 6 11" stroke="currentColor" stroke-linecap="round"/>
      </svg>
    </a>
    
  </div>
  

  


</article>

        </div><footer class="footer">
  <p>&copy; 2025 <a href="https://hzhsec.github.io/">Hzhsrc home</a>
    Powered by
    <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo️️</a>
    <a href="https://github.com/guangzhengli/hugo-theme-ladder" rel="noopener" target="_blank">Ladder</a>
️  </p>
</footer>

<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211C22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257M21.7387 7.71865C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257C17.1684 -1.24629 7.83127 0.632493 4.27577 5.04257C2.88063 6.77451 -0.0433281 11.1668 1.38159 16.6571C2.27481 20.0988 5.17269 22.2936 8.19743 22.7725M20.7188 5.04257C22.0697 6.9404 24.0299 11.3848 22.3541 15.4153M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814C11.1703 6.98257 11.0247 6.98456 10.9937 7.05061C10.5221 8.05496 9.07362 9.92941 8 10.945M11.0333 7.44444C10.9392 9.86549 11 15 12 17" stroke="currentColor" stroke-linecap="round"/>
    </svg>
</a>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>

<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'Copy';

        function copyingDone() {
            copybutton.innerHTML = 'Copied';
            setTimeout(() => {
                copybutton.innerHTML = 'Copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });
        codeblock.parentNode.appendChild(copybutton);
    });
</script></main>
    </body>
  
  <script src="/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js" integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin="anonymous" defer></script></html>
